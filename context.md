# План разработки веб-приложения To-Do с интеграцией Telegram Apps SDK и IO Intelligence API

Ниже представлен детальный план по созданию веб-приложения для составления списка задач (to-do list), а также для работы с искусственным интеллектом (AI). Приложение основано на **TypeScript**, **React** и **Telegram Apps SDK**. Также в нём предусмотрена интеграция с провайдером AI через **IO Intelligence API**. Дизайн и функционал необходимо воспроизвести **точно** по предоставленным скриншотам.

---

## 1. Общий обзор проекта

1. **Основное назначение**: 
   - Создание, хранение и управление списком задач пользователя.
   - Предоставление возможности задать вопрос нейросети и получить единоразовый ответ.
   - Поддержка системы подписок: `pro trial` (3-дневный пробный период) и `premium`.
   - Отображение профиля пользователя Telegram (аватар и тип подписки) в верхней части экрана.

2. **Основные механики**:
   - **Добавление задачи**: при нажатии на кнопку «New Task» появляется окно (модальное или всплывающее) для ввода текста задачи.
   - **Выполнение задачи**: при нажатии на чекбокс/кнопку сбоку задача помечается синим цветом и **через 5 секунд** исчезает из списка (даётся время на отмену, если нажатие было ошибочным).
   - **Задание вопроса AI**: в нижней части экрана располагается строка ввода для пользовательского вопроса к нейросети. Поддерживается механизм «контекстных» вставок (например, `<task>Создать сайт</task>`), которые отображаются в виде небольших цветных "чипов" внутри поля ввода.
   - **Система подписок**:
     - `pro trial`: действует 3 дня.
     - `premium`: постоянная/долгосрочная подписка.
   - **Хранение пользовательских данных**: предлагается использовать [Cloud Storage из Telegram Apps SDK](https://docs.telegram-mini-apps.com/packages/telegram-apps-sdk/3-x/components/cloud-storage). Если этот вариант будет недостаточен, нужно предложить альтернативу (например, собственный бэкенд на Firebase или AWS).

3. **Стек**:
   - **Фронтенд**: React + TypeScript.
   - **AI**: [IO Intelligence API](https://docs.io.net/reference/get-started-with-io-intelligence-api).
   - **Telegram Apps SDK**: для интеграции с Telegram Mini Apps и использования Cloud Storage.

---

## 3. Дизайн приложения

### 3.1. Внешний вид по скриншотам

1. **Главный экран**:
   - Сверху аватар пользователя Telegram и статус подписки (`pro trial` или `premium`). Рядом может отображаться счётчик задач (`0/0`, `4/6`, `12/34` и т.п.).
   - Ниже расположен список задач. Каждая задача — это отдельный блок:
     - Чекбокс или кнопка для пометки выполнения (справа или слева, по скриншотам видно сбоку).
     - Название задачи.
     - Если задача выполнена, она подсвечивается синим цветом и **удаляется через 5 секунд**.
   - Кнопка «New Task» (или «Добавить задачу») открывает окно ввода новой задачи.
   - В самом низу строка ввода вопроса для AI. Рядом с полем могут быть «контекстные» блоки (чипы) синего цвета для `<task>…</task>` и т.п.

2. **Модальное окно добавления задачи**:
   - Простое поле ввода для текста задачи.
   - Кнопка «Добавить».

3. **Отображение статусов задач**:
   - При **активной** задаче: белый фон (или другой цвет в зависимости от темы), чёрный/тёмный текст.
   - При **выполнении** задачи: задача подсвечивается синим цветом (согласно скриншотам) и через 5 секунд исчезает.
   - Стиль списков, фон приложения и цветовая схема берутся из **Telegram theme** (подробно ниже в разделе «Тема и цвета»).

### 3.2. Важность точного воспроизведения

- **Требование**: дизайн должен соответствовать скриншотам **1 в 1**.
- Не допускается придумывать иные элементы или отступы. Всё должно быть, как на предоставленных изображениях.

---

## 4. Функционал работы с задачами

1. **Создание задачи**:
   - Нажатие на «New Task» → открывается модальное окно `AddTaskModal`.
   - Ввод текста задачи → при подтверждении задача добавляется в список (статус «Активная»).

2. **Отметка о выполнении задачи**:
   - Чекбокс/кнопка сбоку. При клике:
     - Меняется состояние задачи на «Выполнена».
     - Фон или текст задачи становится синим (см. скриншоты).
     - Через 5 секунд задача удаляется из списка (или перемещается в архив, если так требуется, но по задаче – именно исчезает).
     - В течение этих 5 секунд пользователь может отменить действие (например, ещё одним нажатием).

3. **Отображение прогресса**:
   - Счётчик `X/Y` (например, `12/34`) указывает на количество выполненных задач / общее число задач.
   - Этот счётчик выводится рядом с аватаром пользователя (или в другом месте, согласно макетам).

4. **Редактирование или удаление задачи**:
   - По задаче не описан отдельный функционал редактирования или полного удаления вручную, но при необходимости можно добавить:
     - Контекстное меню «Редактировать» / «Удалить».
     - Удаление по таймеру при выполнении.

---

## 5. Интеграция с AI (IO Intelligence API)

1. **Цель**: предоставить пользователю возможность задать **один вопрос** нейросети и получить **один ответ** (не чат).
2. **Механика**:
   - Поле ввода внизу экрана, в котором пользователь формирует вопрос.
   - Возможность добавлять «контекстные» блоки (например, `<task>Создать сайт</task>`). В интерфейсе это отображается как синий «чип».
   - При отправке вопроса:
     - Формируем запрос к [IO Intelligence API](https://docs.io.net/reference/get-started-with-io-intelligence-api), передавая туда вопрос и при необходимости структуру контекста.
     - Важно **минимизировать** количество токенов. Можно использовать короткий системный промпт или роль для нейросети, либо предоставить реализацию разработчику (аутсорс).
     - Получаем ответ и отображаем его в приложении (например, в модальном окне или во всплывающем блоке).
   - **Не является чат-ботом**: после получения ответа взаимодействие завершается.

3. **Рекомендации**:
   - Продумать формат передачи контекста: к примеру, `"<task>Создать сайт</task> <task>Сделать дизайн</task>"`.
   - При желании использовать JSON-формат в теле запроса, передавая контекст и вопрос отдельно.

---

## 6. Хранение данных

1. **Telegram Cloud Storage**:
   - Использовать [Cloud Storage из Telegram Apps SDK](https://docs.telegram-mini-apps.com/packages/telegram-apps-sdk/3-x/components/cloud-storage) для хранения:
     - Списка задач (активные, выполненные).
     - Информации о подписке (`pro trial`, `premium`).
     - Даты начала пробного периода.
   - При первом запуске приложения проверять наличие сохранённых данных.
   - При изменении задач (добавление, выполнение) данные синхронизируются с облаком Telegram.

2. **Альтернативные решения** (если Cloud Storage не подходит):
   - **Firebase** (Firestore) или **AWS DynamoDB**.
   - **Собственный сервер** (Node.js + база данных по выбору).
   - Важно учитывать, что пользователь авторизуется через Telegram, и может быть удобнее хранить всё внутри Telegram для бесшовного UX.

---

## 7. Система подписок

1. **Варианты подписок**:
   - `pro trial`: активируется при первом запуске на 3 дня.
   - `premium`: постоянная подписка (механизм оплаты или подтверждения за рамками данного ТЗ, но нужно предусмотреть логику хранения статуса).

2. **Логика работы**:
   - При входе в приложение проверяем статус пользователя:
     - Если у него нет подписки — даём `pro trial` на 3 дня.
     - Если `pro trial` истекла — ограничить функционал или предложить оплату `premium`.
     - Если есть `premium` — полный доступ.
   - Статус подписки отображается в интерфейсе (рядом с аватаром, как на скриншотах).

3. **Хранение**:
   - В **Cloud Storage** храним флаг подписки и дату начала `pro trial`.
   - Если дата + 3 дня > текущая дата, подписка `pro trial` активна; иначе — нет.

---

## 8. Тема и цвета

1. **Параметры цвета** берутся из настроек Telegram. Пример объекта:
   ```json
   {
     "accent_text_color": "#6ab2f2",
     "bg_color": "#17212b",
     "button_color": "#5288c1",
     "button_text_color": "#ffffff",
     "bottom_bar_bg_color": "#ffffff",
     "destructive_text_color": "#ec3942",
     "header_bg_color": "#17212b",
     "hint_color": "#708499",
     "link_color": "#6ab3f3",
     "secondary_bg_color": "#232e3c",
     "section_bg_color": "#17212b",
     "section_header_text_color": "#6ab3f3",
     "subtitle_text_color": "#708499",
     "text_color": "#f5f5f5"
   }
